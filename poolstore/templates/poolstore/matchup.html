{% extends 'poolstore/base.html' %}
{% load static %}
{% load next_item_filter %}
{% block content %}


   
   
      <div class="row">
         <div class="col-lg-4">
            <div id="matchup-hold">
               
               {% for matchup in matchups %}
               <div class="border d-flex align-items-center my-3" 
               hx-trigger='click' 
               hx-get="{% url 'matchup' matchup.id %}" 
               hx-push-url="/matchup/{{ matchup.id }}/" 
               hx-vals='{"load_type": "load-matchup"}' 
               hx-swap="innerHTML" 
               hx-target="#matchup-chat">
                  <div class="w-25 me-2">
                     <img src="{{ matchup.messages.last.sender.profile_image.url}}" class="img-fluid">
                  </div>

                  <div class="w-75" >
                     <div class="h6">
                        {{ matchup.messages.last.sender.user.first_name}} {{ matchup.messages.last.sender.user.last_name}}
                     </div>

                     <div class="mt-4">
                        {{ matchup.messages.last.body }}
                     </div>
                  </div>
               </div>
               {% endfor %}
               
            </div>
         </div>

         <div class="col-lg-7 col-12 " style="position: relative; padding: 0;" id="matchup-chat">

         {% include 'poolstore/partials/matchup_chat.html' %}

         </div>
      </div>
   
    
   {{ request.user.username|json_script:"username" }}

   {{ matchup.id|json_script:"matchup_id" }}
   <script src="{% static 'js/matchup_v2.js' %}"></script>

   <script>
   

   document.addEventListener('DOMContentLoaded', function() {
        scrollBottom();
    })

    console.log(document.getElementById('saved-message-holder').lastElementChild);

   document.getElementById('matchup-chat').addEventListener('htmx:afterSwap', (e) => {
      scrollBottom();
   });

   </script>

{% endblock %}